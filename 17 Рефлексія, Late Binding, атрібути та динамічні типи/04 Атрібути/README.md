# Атрібути

Для почтаку зрозумійте шо метадані це дані, що характеризують або пояснюють інші дані. Однією з функцій компілятора .NET є генерація описів метаданих для всіх визначених і посилальних типів. На додаток до цих стандартних метаданих, що містяться в будь-якій збірці, платформа .NET надає програмістам можливість вбудовувати додаткові метадані в збірку за допомогою атрибутів. Атрибути — це не що інше, як анотації коду, які можна застосувати до заданого типу (класу, інтерфейсу, структури тощо), члена (властивості, методу тощо), збірки чи модуля.

Атрибути .NET — це типи класів, які розширюють абстрактний базовий клас System.Attribute. Досліджуючи простори імен .NET, ви знайдете багато попередньо визначених атрибутів, які можна використовувати у своїх програмах. Крім того, ви можете створювати власні атрибути для подальшої кваліфікації поведінки ваших типів, створюючи новий тип, похідний від Attribute.Бібліотека базових класів .NET надає атрибути в різних просторах імен.

Приклади вбудованих атрибутів.

[CLSCompliant] : Забезпечує відповідність анотованого елемента правилам загальномовної специфікації (CLS). Пам’ятайте, що CLS-сумісні типи гарантовано безпроблемно використовуватимуться в усіх мовах програмування .NET.

[DllImport] : Дозволяє коду .NET здійснювати виклики до будь-якої некерованої бібліотеки коду на основі C або C++, включаючи API основної операційної системи.

[Obsolete] : Позначає застарілий тип або член. Якщо інші програмісти спробують використати такий елемент, вони отримають попередження компілятора з описом помилки своїх шляхів.

Коли ви застосовуєте атрибути у своєму коді, вбудовані метадані, по суті, марні, доки інша частина програмного забезпечення явно не відобразить інформацію. Якщо це не так, анотація метаданих, вбудованих у збірку, ігнорується та є абсолютно нешкідливим.

### Що використовує атрібути.

Як ви здогадалися, .NET Framework постачається з численними утилітами, які справді шукають різні атрибути. Сам компілятор C# (csc.exe) був попередньо запрограмований на виявлення наявності різних атрибутів під час циклу компіляції. Наприклад, якщо компілятор C# зустрічає атрибут [CLSCompliant], він автоматично перевіряє атрибутований елемент, щоб переконатися, що він надає лише CLS-сумісні конструкції. Як інший приклад, якщо компілятор C# виявляє елемент, якому присвоєно атрибут [Obsolete], він відобразить попередження компілятора.
На додаток до засобів розробки, численні методи в бібліотеках базових класів .NET попередньо запрограмовані для відображення конкретних атрибутів. В наступних розділах представлено серіалізацію XML і JSON, обидва з яких використовують атрибути для керування процесом серіалізації.
Ви можете створювати програми, які запрограмовані на відображення ваших власних атрибутів, а також будь-яких атрибутів у бібліотеках базових класів .NET. Роблячи це, ви, по суті, можете створити набір «ключових слів», які розуміються певним набором збірок.
 
## Застосування атрибутів.

Створемо проект та додамо пакет NuGet System.Text.Json.  Припустімо, ви хочете створити клас під назвою Motorcycle які можна зберегти у форматі JSON. Якщо у вас є поле, яке не слід експортувати в JSON, ви можете застосувати атрибут [JsonIgnore].

ApplyingAttributes\Motorcycle.cs

```cs
internal class Motorcycle
{
    [JsonIgnore]
    public float weightOfCurrentPassengers; // This fild is unserializable
    // These fields are still serializable.
    public bool hasRadioSystem;
    public bool hasHeadSet;
    public bool hasSissyBar;
}

```
Атрибут застосовується до конкретного наступного елемента. Коли ви хочете застосувати атрибут, ім’я атрибута береться в квадратні дужки.
Один елемент може мати кілька атрибутів. Припустімо, що у вас є застарілий тип класу C# (HorseAndBuggy), якому було приписано власний простір імен XML. База коду змінювалася з часом, і тепер клас вважається застарілим для поточної розробки. Замість того, щоб видаляти визначення класу з бази коду (і ризикувати зламати існуюче програмне забезпечення), ви можете позначити клас атрибутом [Obsolete]. Щоб застосувати кілька атрибутів до одного елемента, просто використовуйте список, розділений комами або один над одним.

```cs
//[XmlRoot(Namespace = "http://www.MyCompany.com"), Obsolete("Use another vehicle!")]
[XmlRoot(Namespace = "http://www.MyCompany.com")]
[Obsolete("Use another vehicle!")]
internal class HorseAndBuggy
{
    //...
}
```
Якщо ви переглядали документацію .NET, ви могли помітити, що фактичне ім’я класу атрибута [Obsolete] є ObsoleteAttribute, а не Obsolete. Відповідно до домовленості про найменування, усі атрибути .NET суфіксуються маркером Attribute. Однак, щоб спростити процес застосування атрибутів, мова C# не вимагає від вас введення суфікса Attribute. Враховуючи це, наступна ітерація типу HorseAndBuggy ідентична попередньому прикладу 

```cs
[XmlRootAttribute(Namespace = "http://www.MyCompany.com")]
[ObsoleteAttribute("Use another vehicle!")]
internal class HorseAndBuggy
{
    //...
}
```

### Параметри атрибутів. 

Зверніть увагу, що атрибут [Obsolete] може приймати те, що виявляється параметром конструктора. Якщо ви переглянете формальне визначення атрибута [Obsolete], то побачите, що цей клас справді надає конструктор, який отримує System.String

```cs
public sealed class ObsoleteAttribute : Attribute
{
  public ObsoleteAttribute();
  public ObsoleteAttribute(string? message);
  public ObsoleteAttribute(string? message, bool error);
  public string? Message { get; }
  public bool IsError { get; }
  public string DiagnosticId { get; set; }
  public string UrlFormat { get; set; }
}
```
Коли ви надаєте параметри конструктора атрибуту, атрибут не виділяється в пам’ять, доки параметри не будуть відображені іншим типом або зовнішнім інструментом. Рядкові дані, визначені на рівні атрибутів, просто зберігаються в збірці як анотація метаданих.

### Атрібут [Obsolete] в дії.

Спробуємо створити примірник класу HorseAndBuggy який визначчений атрибутом [Obsolete].

```cs
HorseAndBuggy horseAndBuggy = new();
```
Коли ви створете екземпляр класу компілятор виделить його з попередженням. 

```
CS0618: 'HorseAndBuggy' is obsolete: 'Use another vehicle!'
```

Таким чином.

Атрибути — це класи, які походять від System.Attribute.
Результатом атрибутів є вбудовані метадані класів або їх членів.
Атрибути застосовуються в C# за допомогою квадратних дужок.
Атрибути в основному марні, поки інший агент (включаючи IDE) не відобразить їх.



